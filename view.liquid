{% case template.name %}

    {% when "product" %}
        <script>
            dataLayer.push({ecommerce: null});
            dataLayer.push({
                event: "view_item",
                ecommerce: {
                    currency: "USD",
                    items: [
                        {
                            item_id: {{ product.id }},
                            item_name: {{ product.title | json }},
                            item_variant: {{ product.variants[0].title | json }},
                            price: {{ product.price | divided_by: 100 }},
                            quantity: 1
                        }
                    ]
                }
            });
        </script>

    {% when "collection" %}
        <script>
            // GA4
            dataLayer.push({ecommerce: null});
            dataLayer.push({
                event: "view_item_list",
                ecommerce: {
                    currency: "USD",
                    item_list_id: {{ collection.id }},
                    item_list_name: {{ collection.title | json }},
                    items: [
                        {% for product in collection.products %}
                        {
                            item_id: {{ product.id }},
                            item_name: {{ product.title | json }},
                            item_variant: {{ product.variants[0].title | json }},
                            price: {{ product.price | divided_by: 100 }},
                        },
                        {% endfor %}
                    ]
                }
            });
        </script>

    {% when "cart" %}
        <script>
            // fire ga
            dataLayer.push({ecommerce: null});
            dataLayer.push({
                event: "view_cart",
                ecommerce: {
                    currency: "USD",
                    value: {{ cart.total_price | divided_by: 100 }},
                    items: [
                        {% for item in cart.items %}
                        {
                            item_id: {{ item.product_id }},
                            item_name: {{ item.product.title | json }},
                            item_variant: {{ item.variant.title | json }},
                            price: {{ item.final_line_price | divided_by: 100 }},
                            quantity: {{ item.quantity }}
                        },
                        {% endfor %}
                    ]
                }
            });
        </script>
{% endcase %}
